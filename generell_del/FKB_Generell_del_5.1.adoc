= SOSI abstrakte spesifikasjoner: FKB generell del 5.1
Geovekst
5.1, 2024-05-01
:toc: left
:toc-title: Innholdsfortegnelse
:toclevels: 4
:sectnums:
:sectnumlevels: 4
:figure-caption: Figur
:table-caption: Tabell
:section-refsig: Kapittel
:version-label: Versjon
:doctype: book
:encoding: utf-8
:lang: nb
:appendix-caption: Vedlegg
:pdf-page-size: A4
ifdef::backend-pdf[:toc: macro]
:chapter-label! :
:fkb-url: https://sosi.geonorge.no/standarder/FKB_generell_del/5.1
:prodspek-url: https://sosi.geonorge.no/produktspesifikasjoner/
:reginstr-url: https://sosi.geonorge.no/registreringsinstrukser/
:uml-url: http://sosi.geonorge.no/uml-modeller/sosi-del-2-generell-objektkatalog/FKB_generell_del/5.1
:fkbdatasett: FKB Generell del 5.1
:publisert: 2024-05-01

// Dokument metadata

****

*Publisert*: {publisert} +

*Denne versjonen finnes på*: {fkb-url} +
- {fkb-url}[HTML-dokument] +
- {uml-url}[HTML-visning av UML-modellen] +

*Nyeste versjon finnes på*: https://sosi.geonorge.no/standarder/FKB_generell_del +
*Denne versjonen erstatter*: https://sosi.geonorge.no/standarder/FKB_generell_del/5.0.1[FKB 5.0.1 2023-01-01] +

*Faglig ansvarlig*: Geovekst +
*Aktuell ansvarlig*: Kartverket +

Vedtatt som standard av Standardiseringskomiteen for Geomatikk 

****

toc::[]

== Orientering og introduksjon
=== Innledning
Dette dokumentet er en generell overbygning over de enkelte FKB-produktspesifikasjonene og angir generelle mekanismer i FKB og hvordan de forskjellige delene av spesifikasjonen skal sees i sammenheng.

=== Definisjon av Felles KartdataBase (FKB)
[#FKB]
FKB er en samling datasett som utgjør en sentral del av grunnkartet

=== Formål med FKB

include::../felles/kap38_formal.adoc[]

=== Ansvar for FKB
FKB er spesifisert i FKB produktspesifikasjoner. Geovekst-samarbeidet har ansvar for utvikling av disse spesifikasjonene. Dette gjøres i nært samarbeid med kommunene utenfor Geovekst, andre brukere, produsenter og systemleverandører. Geovekst-forum har ansvar for å iverksette arbeid for å utarbeide nye eller revidere FKB-spesifikasjoner og vedtar FKB produktspesifikasjonene. 

Det meste av etableringen av FKB-data skjer også gjennom Geovekst-samarbeidet og rettighetshavere vil da være Geovekst-partene. For enkelte områder vil FKB-data være etablert utenfor Geovekst og har andre eier- og rettighetsforhold. 

Se mer om Geovekst-samarbeidet på https://www.kartverket.no/geodataarbeid/geovekst[Kartverkets hjemmesider].

=== Kriterier for FKB
Ved vurdering av hvilke datasett/objekter som skal inngå i FKB er følgende kriterier viktige:

* FKB-data skal være vektordata
* FKB-data skal ha et etablert forvaltningsopplegg (FDV) 
* FKB-data skal normalt ha en homogen nasjonal dekning
* FKB-data skal normalt ikke være sikkerhetsgraderte data  
* FKB-data skal normalt være topografiske/fysiske data (grunnkart/basisdata)
* Data som bare er interessante for en etat/part vil normalt ikke inngå i FKB

=== Geovekst-data - fullstendighet, kvalitet og rettslig gyldighet
FKB-data, ortofoto og laserdata (Geovekst-data) som selges gjennom kommunen eller Kartverkets forhandlere er etablert og finansiert gjennom Geovekst-samarbeidet eller kommunene alene for kommuner utenfor Geovekst-samarbeidet. Disse er også rettighetshavere til dataene. 

Geovekst-dataene er de mest detaljerte og best oppdaterte geodataene som er tilgjengelig. Dataene skal gi en best mulig gjengivelse av terrenget og menneskeskapte objekter med varierende innhold, detaljering og nøyaktighet. Det skjer kontinuerlig endringer i terrenget (flom, ras, brann m.m.), objekter bygges og fjernes, så det kan ikke forventes at alle områder til enhver tid er 100% oppdaterte.  

Datasettene kan derfor ha varierende fullstendighet og kvalitet. Brukere som har spesielle krav til dette, _MÅ_ undersøke fullstendighet og kvalitet før bruk. 

Geovekst-dataene er ikke rettslig gyldige. 

<<<

== Historikk og status
De første versjonene av FKB produktspesfikasjon oppsto samtidig med Geovekst-samarbeidet tidlig på 1990-tallet. Datainnholdet ble i tidlig fase utformet slik at det skulle tilsvare datainnholdet i Teknisk kartverk 1:1000 (TK) og Økonomisk Kartverk 1:5000 (ØK). Senere har det kommet større og mindre revisjoner med jevne mellomrom. Her listes ut noen av de store oppdateringene:

* 1995: FKB 2.2
* 2003: FKB 3.3
* 2007: FKB 4.0
* 2016: FKB 4.6

Fram til innføring av FKB 4.0 ble FKB regnet som _en_ produktspesifikasjon. Ved innføring av FKB 4.0 ble de ulike datasettene i FKB skilt ut som egne produktspesifikasjoner og dokumentet FKB generell del (dette dokumentet) ble etablert for å beskrive de felles rammene for FKB-produktspesfikasjonene.

For komplett oversikt over endringer mellom tidligere versjoner henvises det til endringslogg i de enkelte versjonene.

=== Endringslogg

==== Endringer fra FKB 5.0.1 2023-01-01 til FKB 5.1 2024-05-01

* Nytt kapittel 1.6 om fullstendighet, kvalitet og rettslig gyldighet for Geovekst-data
* Oppdatert tabell 1 (kapittel 6.1) med referanser til oppdaterte FKB produktspesifikasjoner og fotogrammetriske registreringsinstrukser
* Endret kapittelstruktur og navn under kapittel 6.2 og oppdatert av høydegrunnlag i kap 6.2.2
* Oppdatert beskrivelse av modellering av assosiasjoner i FKB i kap 7.1.3
* Lagt inn referanse til produktspesifikasjon AvvikKartdata 1.0 i kapittel 8.4
* Lagt inn generelle retningslinjer for fotogrammetrisk datafangst av FKB som vedlegg D


==== Endringer fra FKB 5.0 2022-01-01 til FKB 5.0.1 2023-01-01

Oppdatert tabell 1 (kapittel 6.1) med referanser til oppdaterte FKB produktspesifikasjoner og fotogrammetriske registreringsinstrukser

==== Endringer fra FKB 4.6 2020-01-01 til FKB 5.0 2022-01-01
Punktene under beskriver de største endringene i FKB 5.0 sammenlignet med FKB 4.6 2020-01-01.

*Håndtering av kodelister:*

Alle kodelister i FKB 5.0 forvaltes i https://register.geonorge.no/sosi-kodelister/fkb[Geonorge kodelisteregister]. Se mer om rammer for bruk av kodelister i FKB under <<Kodelister>>.

*Assosiasjoner:*

Det er åpnet for at vanlige assosiasjoner kan tas i bruk til å beskrive andre typer sammenhenger mellom objekter enn å beskrive flategeometri. F.eks. at et Bygning-objekt vet hvilke Veranda-objekter som "tilhører" bygget. Assosiasjonene modelleres i tråd med reglene i SOSI del 1 Regler for UML-modellering <<SOSI-UML>>. Se mer om rammer for bruk av assosiasjoner i FKB under <<Assosiasjoner>>.

*Flategeometri:*

Tidligere versjoner av FKB har basert seg på SOSI-formatets flategeometri som innebærer at alle flateobjekttyper må avgrenses av en eller flere avgrensningsobjekter og skal ha et representasjonspunkt. Dette er nå endret slik at flater som hovedregel modelleres med heleid geometri og uten representasjonspunkt. 
Der det er behov skal det likevel fortsatt modelleres representasjonspunkt og settes krav til sammenheng mellom flategeometrien og geometrien til egne avgrensningsobjekter. Dette modelleres som en assosiasjon etter gitte regler. Se nærmere beskrivelse under <<Flategeometri>>. 

*Id-håndtering; Identifikasjon av objektene i FKB og pekere til Id-er i eksterne systemer:*

Regler for bruk av _identifikasjon_ er presisert og pekere til eksterne systemer i form av URI-er <<URI>> er lagt inn på en lang rekke nye objekttyper. Les mer under  <<Identifikasjon av objekter i FKB>>.

*Endringer i fellesegenskaper:*

Det er gjort noen justeringer i fellesegenskapene i FKB Generell del, dvs. hvilke egenskaper som er lovlig å benytte på objektene i FKB. Følgende endringer er gjort:

* Datatypen posisjonskvalitet er endret. Den største endringen er at kodeliste _målemetode_ er erstattet av den enklere _datafangstmetode_. I tillegg er _nøyaktighet_ endret fra påkrevd til opsjonell og definisjoner etc. er gjennomgått og presisert.
* Egenskapen _registreringsversjon_ er endret fra å være definert som en datatype til å bli en kodeliste.
* Egenskapene _kopidata_ og _prosesshistorie_ er ikke lenger definert som del av fellesegenskapene som skal brukes ved forvaltning av FKB.
* Egenskapen _sluttdato_ er lagt til som en del av fellesegenskapene. Denne er en egenskap som i likhet med _oppdateringsdato_ styres av forvaltningssytemet og den er lagt til for å kunne støtte utveksling av data fra historiske spørringer. Egenskapen skal normalt ikke inngå i en leveranse av levende FKB-data (sluttdato vil da ikke ha noen verdi).


*Oppdatert kvalitetsmodell:*

Modell for å beskrive krav til kvalitet og dokumentere kvalitet på FKB-data er oppdatert. Ny modell baserer seg mer direkte på standarden Geodatakvalitet <<G>>, noe som blant annet medfører at det i FKB 5.0 settes krav til både systematiske og tilfeldige avvik. Se mer under <<Kvalitet>>.

*Endret dokumentasjon:*

Dokumentasjon av FKB produktspesifikasjon er totalt omarbeidet slik at det nå er HTML som er standardformatet (fortsatt med PDF som et alternativ). Dette bør gjøre det lettere å hoppe mellom de ulike delene av FKB produktspesifikasjonene. Nytt format og nye verktøy gjør at ganske mye av dokumentasjonen er omarbeidet. Det er imidlertid forsøkt å gjenbruke innholdet mest mulig. Der det er vesentlige endringer i _innholdet_ skal dette være beskrevet i endringsloggen for det enkelte FKB-datasett. 


=== Revisjon
FKB produktspesifikasjonene oppdateres ved behov. Hver enkelt FKB produktspesifikasjon kan oppdateres uavhengig av de andre. De generelle retningslinjene for FKB (dette dokumentet) vil normalt oppdateres ved hver oppdatering av et underkapittel. 

Hver enkelt FKB produktspesifikasjonen skal oppdateres maksimalt 1 gang pr. år og ny versjon utgis fortrinnsvis ved nyttår. 

En versjon av et FKB-kapittel identifiseres ved et versjonsnummer. Dette nummeret er knyttet til datamodellen (objektkatalogen/applikasjonsskjema). I tillegg kan det utgis revisjoner av FKB-kapitler som ikke innebærer endring i objektkatalog (for eksempel presiseringer i registreringsinstruks for fotogrammetrisk kartlegging). Disse revisjonene merkes da med ny dato, men ikke nytt versjonsnummer. 

<<<

== Omfang

=== Dokumentet omfatter
Dette dokumentet beskriver generelle og prinsipielle forhold som er felles for alle FKB produktspesifikasjonene. 

=== Bruksområde for dokumentet
Dette dokumentet er en viktig referanse for de enkelte FKB produktspesifikasjonene.
Mange av begrepene/konseptene som benyttes i FKB forklares i dette dokumentet. 

<<<

== Normative referanser

Det er nødvendig å ha kjennskap til dokumentene under for fullt ut å forstå denne produktspesifikasjonen.

[#G]
*[G]* : https://register.geonorge.no/standarder/sosi/standarder-geografisk-informasjon/geodatakvalitet[Geodatakvalitet, versjon 1.0 2015]

[#GEO-VEIL]
*[GEO-VEIL]* : https://www.kartverket.no/geodataarbeid/geovekst/veiledningsmateriell-geovekst[Geovekst veiledingsdokumentasjon]

[#ISO-METADATA]
*[ISO-METADATA]* : 19115-1:2015 Geographic information - Metadata - Part 1: Fundamentals og 19115-2:2015 Geographic information - Metadata - Part 2: Extensions for acquisition and processing

[#PABG]
*[PABG]* : https://register.geonorge.no/standarder/sosi/standarder-geografisk-informasjon/produksjon-av-basis-geodata[Produksjon av basis geodata, versjon 1.0 2015]

[#PBL-KART]
*[PBL-KART]* : https://www.regjeringen.no/no/dokumenter/veiledning-til-forskrift-om-kart-stedfestet-informasjon-arealformal-og-digitalt-planregister/[Veiledning til forskrift om kart, stedfestet informasjon, arealformål og digitalt planregister]

[#SOSI-UML]
*[SOSI-UML]* : https://register.geonorge.no/standarder/sosi/del-1-generell-del/regler-for-uml-modellering[SOSI Regler for UML-modellering, versjon 5.1 2020]

[#SOSI-KRAV]
*[SOSI-KRAV]* : https://register.geonorge.no/standarder/sosi/del-1-generell-del/sosi-produktspesifikasjoner-krav-og-godkjenning[SOSI produktspesifikasjoner – Krav og godkjenning, versjon 5.0 2014]

[#SOSI-FORMAT]
*[SOSI-FORMAT]* : https://register.geonorge.no/standarder/sosi/del-1-generell-del/realisering-i-sosi-format[SOSI Realisering i SOSI-format, versjon 5.0 2018]

[#SOSI-GML]
*[SOSI-GML]* : https://register.geonorge.no/standarder/sosi/del-1-generell-del/realisering-i-gml-format[SOSI Realisering i GML-format, versjon 5.0 2018]

<<<

== Definisjoner og forkortelser

=== Definisjoner

include::../felles/kap21_definisjoner.adoc[]

=== Forkortelser

include::../felles/kap22_forkortelser.adoc[]

<<<

== Generelt om FKB
=== FKB-datasett

[[tab-fkb_datasett]]
.Tabellen angir hvilke datasett som regnes som FKB-datasett i denne versjonen av FKB.
[cols="4*", options="header"]
|===
|FKB-datasett
|Versjon
|Forvaltning
|Registreringsinstruks

|{prodspek-url}FKB-AR5[FKB-AR5]
|5.1
|Sentral FKB
|Ikke aktuelt

|{prodspek-url}FKB-Arealbruk[FKB-Arealbruk]
|5.0.2
|Sentral FKB 
|{reginstr-url}FKB-Arealbruk/5.0/Fotogrammetrisk_2024-01-01[Fotogrammetrisk FKB-Arealbruk 5.0 2024-01-01]

|{prodspek-url}FKB-Bane[FKB-Bane]
|5.0.1
|Sentral FKB
|{reginstr-url}FKB-Bane/5.0/Fotogrammetrisk_2022-01-01[Fotogrammetrisk FKB-Bane 5.0 2022-01-01]

|{prodspek-url}FKB-BygnAnlegg[FKB-BygnAnlegg]
|5.1
|Sentral FKB
|{reginstr-url}FKB-BygnAnlegg/5.0/Fotogrammetrisk_2024-01-01[Fotogrammetrisk FKB-BygnAnlegg 5.0 2024-01-01]

|{prodspek-url}FKB-Bygning[FKB-Bygning]
|5.1
|Sentral FKB
|{reginstr-url}FKB-Bygning/5.0/Fotogrammetrisk_2024-01-01[Fotogrammetrisk FKB-Bygning 5.0 2024-01-01]

|{prodspek-url}FKB-Høydekurve[FKB-Høydekurve]
|5.0.3
|Sentral FKB 
|{reginstr-url}FKB-Høydekurve/5.0/Punktsky_2022-01-01[Punktsky FKB-Høydekurve 5.0 2022-01-01]

|{prodspek-url}FKB-Ledning/[FKB-Ledning]
|5.1
|Sentral FKB
|{reginstr-url}FKB-Ledning/5.0/Fotogrammetrisk_2024-01-01[Fotogrammetrisk FKB-Ledning 5.0 2024-01-01]

{reginstr-url}FKB-Ledning/5.0/Punktsky_2022-01-01[Punktsky FKB-Ledning 5.0 2022-01-01]

|{prodspek-url}FKB-Lufthavn/[FKB-Lufthavn]
|5.0.2
|Sentral FKB
|{reginstr-url}/FKB-Lufthavn/5.0/Fotogrammetrisk_2022-01-01[Fotogrammetrisk FKB-Lufthavn 5.0 2022-01-01]

|{prodspek-url}FKB-Naturinfo[FKB-Naturinfo]
|5.0.1
|Sentral FKB
|{reginstr-url}FKB-Naturinfo/5.0/Fotogrammetrisk_2024-01-01[Fotogrammetrisk FKB-Naturinfo 5.0 2024-01-01]

|{prodspek-url}FKB-Tiltak[FKB-Tiltak]
|5.1
|Sentral FKB
|Ikke aktuelt

|{prodspek-url}FKB-TraktorvegSti[FKB-TraktorvegSti]
|5.0
|Sentral FKB
|{reginstr-url}/FKB-TraktorvegSti/5.0/Fotogrammetrisk_2024-01-01[Fotogrammetrisk FKB-TraktorvegSti 5.0 2024-01-01]

|{prodspek-url}FKB-Vann[FKB-Vann]
|5.1
|Sentral FKB
|{reginstr-url}/FKB-Vann/5.0/Fotogrammetrisk_2024-01-01[Fotogrammetrisk FKB-Vann 5.0 2024-01-01]

|{prodspek-url}FKB-Veg[FKB-Veg]
|5.1
|Sentral FKB
|{reginstr-url}/FKB-Veg/5.0/Fotogrammetrisk_2024-01-01[Fotogrammetrisk FKB-Veg 5.0 2024-01-01]

|Elveg (vegnett) 

(følger bare delvis reglene for resten av FKB)
|{prodspek-url}SOSI_standardisert_produktspesifikasjon_Elveg_2.0.pdf[Produktspesifikasjon Elveg 2.0]
|NVDB (med oppdatering fra kommunene gjennom Sentral FKB. Det jobbes med å ferdigstille produktspesifikasjonen NVDB Vegnett Plus som skal ta over for ELveg 2.0 i denne sammenhengen)
|{reginstr-url}/Elveg/2.0/Fotogrammetrisk_2024-01-01[Fotogrammetrisk Elveg 2.0 2024-01-01]

|===

=== Detaljeringsgrad og datainnhold i FKB

==== Områdetyper og FKB kartleggingsstandarder
Det viktigste prinsippet i FKB er at en søker å kartlegge det samme området kun en gang, og at en kan benytte etablerte data til ulike formål. Dette kan for eksempel være kartproduksjon eller mer intelligente analysefunksjoner.

Behovene for FKB-data i en kommune varierer avhengig av hvilke formål datasettene skal brukes til. I FKB er det spesifisert FKB-standarder (FKB-A, FKB-B, FKB-C og FKB-D) som skal dekke behovet for felles kartdata i kommunens ulike områdetyper. 

Detaljinnhold og stedfestingsnøyaktighet i FKB varierer i de ulike standardene, med størst detaljering og stedfestingsnøyaktighet i A-standarden og minst i D-standarden. Inndelingen i FKB-standarder setter krav til minimum detaljeringsgrad og stedfestingsnøyaktighet.

De ulike standarder kan benyttes slik at det for eksempel innen en kommune dannes et lappeteppe der flere av standardene er i bruk. Dette gir et datagrunnlag som er tilpasset behovet for felles kartdata i de ulike områdene av kommunen. Hvert enkelt (del)område kan bare være tilordnet en standard. Områdeinndelingen i en kommune vil kunne endre seg i takt med nye utbyggingsaktiviteter.

I praktisk vedlikehold av FKB kan det være aktuelt med forenklinger og varierende kompleksitet avhengig av de behov brukerne har. For delområder vil det for eksempel kunne være aktuelt å velge høyere standard enn det som gjelder for områdetypen generelt, for eksempel et hyttefelt i et fjellområde. Behov og ønsker hos brukerne er ofte relatert til kostnader, og kostnader er igjen relatert til metoder for datafangst etc. Det er derfor naturlig at brukeren definerer krav til innhold og krav til FKB-data som etableres. 

Gjennom Geovekst-samarbeidet avgjøres i fellesskap hvilken FKB-standard som skal brukes i et område, og kartleggingskostnadene fordeles ut fra en kost/nytte vurdering. Dersom det er en part som har behov for kart med større detaljering og/eller bedre kvalitet enn de andre, vil denne parten måtte ta en større del av kartleggingskostnaden.

Kommunen har et spesielt ansvar for å påse at det er en tilstrekkelig kartleggingsstandard i kommunen til å utføre planleggingsoppgaver i kommunens ulike områdetyper. 

[[tab-fkb_omradetyper]]
.Oversikt over områdetyper som de ulike FKB-standardene skal benyttes i.
[cols="3*", options="header"]
|===
|FKB-standard
|Områdetype
|Beskrivelse

|FKB-A / FKB-B
|Områdetype 1
|Byområde.

Dette vil som regel være sentrale byområder og tettsteder med høy grad av utnytting eller svært høy grunnverdi.

|FKB-B
|Områdetype 2
|Tettbygd/utbyggingsområder.

Dette vil være områder som i kommuneplanen er eller forutsettes disponert til tettsteds- og utbyggingsformål og som ikke omfattes av områdetype 1.

|FKB-B / FKB-C
|Områdetype 3
|Spredtbygd/dyrket mark/skog.

Dette vil være områder som i kommuneplanen er eller forutsettes disponert til jordbruk eller skogbruk og spredt bebyggelse.

|FKB-D
|Områdetype 4
|Områder med liten eller ingen bebyggelse.

Dette vil være den delen av kommunen som har en ekstensiv arealutnytting og lav grunnverdi: som regel fjellområder eller tilsvarende lite produktive arealer.
|===

[[fig-fkb_omradetyper]]
.Eksempel på FKB-data i en kommune fordelt på områdetyper
image::figurer/fkb_omradetyper.png[alt="Skisse som viser prinsippene for inndeling av en kommune i forskjellige områdetyper"]

[[fig-fkb_omradetyper_georef]]
.Viser eksempel på fordeling av FKB-standarder i et område i Rogaland. Se laget Georef-ABCD i WMS-tjenesten for Georef
image::figurer/fkb_omradetyper_georef.png[alt="Eksempel på kartutsnitt fra Georef-ABCD i Rogaland som viser fordeling av ulike områder i forskjellige FKB-standarder"]

===== FKB-A-standard
*Bruksområde:*

Bruksområder for A-standarden er spesielt innenfor plan og prosjektering i byområder og tettsteder med høy utnyttelsesgrad, der kravet til detaljering, fullstendighet og stedfestingsnøyaktighet er meget stort. Data etablert etter A-standarden skal kunne benyttes som grunnlagsdata i en 3D (by)modell. A-standarden er aktuell som grunnlag for analyse og forvaltningsoppgaver for de mest intensive byområder og tettsteder med høy utnyttelsesgrad. 

FKB-A-data kan benyttes til uttegning av detaljerte kart (målestokk 1:1000 eller bedre), samt utarbeidelse av produkter i målestokk 1:5000 som for eksempel N5 Raster og N5 Kartdata. 

*Detaljering:*

FKB-A er en meget detaljert standard med detaljert registrering av bygninger (arker, verandaer, trapper mv) og med detaljert registrering av høyder på oppstikkende objekter (hus, mur, gjerde, mast med videre). Høydereferansen på objektene er vanligvis topp, mens detaljert terrenggrunnlag gir fothøyden til objektene. 

*Etableringsmetode:*

Storparten av A-dataene etableres fotogrammetrisk (kartkonstruksjon fra flybilder med oppløsning ca 5–8 cm).  

For en del datasett vil A-dataene bli samlet inn fra andre kilder. Dette medfører at disse objektene kan ha dårligere eller bedre stedfestingsnøyaktighet enn det som generelt gjelder for A-standarden.

[[fig-fkb_a]]
.Eksempel på detaljering for bygning-, vann-, veg, vegnett og ledningsdata i A-standarden. Alle objekter i figuren er registrert i tre dimensjoner. I øvre venstre hjørne vises en 3D-modell av bygningen slik den kan dannes fra A-dataene (forutsetter en god terrengmodell). Modellen er her laget med utgangspunkt i takkanten. 
image::figurer/fkb_a_eksempel.png[alt="Skisse som viser eksempel på detaljering for bygning-, vann-, veg, vegnett og ledningsdata i A-standarden"]

===== FKB-B-standard
*Bruksområde:*

B-standarden benyttes i områder med tettbebyggelse og blandet bebyggelse, utbyggingsområder og langs større veger (europa-, riks- og fylkesveger). Denne standarden bør benyttes for de fleste områder utenfor byene der det finnes en viss mengde bygninger og tekniske installasjoner. B-standarden kan benyttes til detaljprosjektering og ved utarbeidelse av reguleringsplaner, men har enkelte begrensninger i forhold til A-standarden. B-standarden kan benyttes som grunnlagsdata for utarbeidelse av 3D-modeller, men disse vil ikke være like detaljert som i A-standarden. 

FKB-B-data kan benyttes til uttegning av detaljerte kart (målestokk 1:1000 eller bedre), samt utarbeidelse av produkter i målestokk 1:5000 som for eksempel N5 Raster og N5 Kartdata. 

*Detaljering:*

FKB-B er en detaljert standard med registrering av bygningsdetaljer (arker, verandaer, trapper med videre) og detaljert registrering av høyder på oppstikkende objekter (bygning, mur, gjerde, mast med videre). Høydereferansen på objektene er vanligvis topp, mens detaljert terrenggrunnlag gir fothøyden til objektene. 
Forskjellen på B-standard og A-standard er i hovedsak at det er større minstemål på objekter før de skal registreres i B-standarden.

*Etableringsmetode:*

Storparten av B-dataene etableres fotogrammetrisk (kartkonstruksjon fra flybilder med oppløsning ca 8–12cm). For en del datasett vil B-dataene kunne bli samlet inn fra andre kilder. Dette medfører at disse objektene kan ha dårligere eller bedre stedfestingsnøyaktighet enn det som generelt gjelder for B-standarden.

[[fig-fkb_b]]
.Eksempel på detaljering for bygning-, vann-, veg, vegnett og ledningsdata i B-standarden. Alle objekter i figuren er registrert i tre dimensjoner. I øvre venstre hjørne vises en 3D-modell av bygningen slik den kan dannes ut fra B-dataene (forutsetter en god terrengmodell). Denne modellen viser hovedformen til bygningen, men er ikke like detaljert som A-standarden. 
image::figurer/fkb_b_eksempel.png[alt="Skisse som viser eksempel på detaljering for bygning-, vann-, veg, vegnett og ledningsdata i B-standarden"]

===== FKB-C-Standard
*Bruksområde:*

C-standarden benyttes i spredt bebygde og ubebygde områder. C-standarden har begrensninger innenfor utarbeidelse av reguleringsplaner, situasjonsplaner og byggeplaner og skal ikke etableres i områder der det er naturlig å etablere FKB-data etter B-standarden. C-standarden kan benyttes som grunnlagsdata for utarbeidelse av enkle 3D-modeller.

FKB-C kan benyttes til utarbeidelse av N5-produkter som for eksempel N5 Raster og N5 Kartdata

*Detaljering:*

FKB-C inneholder bygningers hovedform og de dominerende detaljene i topografien forøvrig. En del mindre detaljer registreres ikke i FKB-C og minstemål for registering er større enn i FKB A-B. Historisk ble detaljeringen i FKB-C utformet slik at den tilsvarte det tidligere økonomiske kartverket (ØK).

*Etableringsmetode:*

Storparten av C-dataene etableres fotogrammetrisk (kartkonstruksjon fra flybilder med oppløsning ca 15-25 cm). For en del datasett vil C-dataene kunne bli samlet inn fra andre kilder. Dette medfører at disse objektene kan ha dårligere eller bedre stedfestingsnøyaktighet enn det som generelt gjelder for C-standarden.

[[fig-fkb_c]]
.Eksempel på detaljering for bygning-, vann-, veg, vegnett og ledningsdata i C-standarden ved fotogrammetrisk datafangst. Alle objekter er registrert i 3 dimensjoner. I enkelte tilfeller vil vanndataene være etablert fra eksisterende ØK ved digitalisering, og da vil disse objektene normalt være representert i 2 dimensjoner. I øvre venstre hjørne vises en 3D-modell av bygningen slik den kan dannes fra C-dataene.
image::figurer/fkb_c_eksempel.png[alt="Skisse som viser eksempel på detaljering for bygning-, vann-, veg, vegnett og ledningsdata i C-standarden"]

===== FKB-D-standard
*Bruksområde:*

D-standarden benyttes i områder med liten eller ingen bebyggelse (stort sett fjellområder).
For å få heldekkende FKB-datasett for en kommune skal D-områdene fylles med data. Dette for å få landsdekkende data slik at vi ikke får ”hvite hull” i datasettene. 

[[fig-fkb_d]]
.Eksempel på FKB-data for et område med og uten data i D-områdene.
image::figurer/fkb_d_innhold.png[alt="Skisse som viser hvordan FKB-data med og uten innhold i FKB-D-områder"]

*Etablering og detaljering:*

For FKB-D data etablert tidligere vil detaljering i hovedsak være lik N50 Kartdata for vann, høyde, stier, traktorveger og bygningsmessige anlegg. Ved nyere etablering fra omløpsfoto vil D-standarden i hovedsak være lik C-standarden. Innholdet vil imidlertid variere fra datasett til datasett.

[[tab-fkb_d_innhold]]
.Beskrivelse av datainnhold i de forskjellige datasettene i FKB-D-områdene.
[cols="2*", options="header"]
|===
|Datasett
|Innhold

|AR5
|Flater med kode "Ikke kartlagt". NIBIO jobber med å fylle AR5 med et forenklet innhold fra skogressurskart (SR16) også i D-områder. 

|Høydekurve
|Høydekurver avledet fra laserskanning eller etablert ved bildematching fra omløpsfoto i NDH-prosjektet. 1m ekvidistanse der det er utført laserskanning og 5m ekvidistanse i områder der det er utført bildematching. Gamle fotogrammetriske kurver kan fortsatt finnes igjen i enkeltområder.

|Vegnett
|Hentes fra NVDB. Samme innhold uavhengig av FKB-standard.

|Tiltak
|Samme innhold uavhengig av FKB-standard. Lite aktuelt i D-områder.

|Vann
|Eksisterende data er hovedsaklig likt N50 i detaljering og innhold. Ved nykonstruksjon er standarden lik C-standarden, med unntak for minstestørrelser for ElvBekk, KanalGrøft og Innsjø.

|TraktorvegSti
|Traktorveger og stier har i utmarksområder et forvaltningsopplegg som i stor grad baserer seg på andre datakilder enn fotogrammetri. Bl.a. samordning med N50 og  friluftsruter. Datainnholdet er i stor grad uavhengig av FKB-standard. 

|Øvrige FKB-datasett
|Lik C-standarden. Forskjellen ligger i at det er færre objekter å kartlegge i D-områder. Områder der det finnes menneskeskapte objekter av et visst omfang er i all hovedsak definert som FKB-C områder. 
|===

==== Høydegrunnlag i FKB
Med unntak av FKB-AR5 kartlegges alle FKB-data med høydeverdier på objektene. FKB-data er såkalt 2.5D. 
Kravene til nøyaktighet for registrering av høydeverdiene på objektene følger også av valgt FKB-standard. 
I de fleste tilfeller registeres høyden på toppen av objektet, men avvik fra dette kan angis ved hjelp av egenskapen _høydereferanse_.

I tillegg inneholder FKB datasettet FKB-Høydekurve som beskriver terrengoverflaten. 
Dette datasettet er hovedsakelig avledet/generert fra Nasjonal Detaljert Høydemodell (NDH) og forholder seg derfor ikke til inndelingen i FKB-standarder på samme måte som andre FKB-datasett.
NDH inneholder punktskyer fra laserskanning i de fleste områder, men noen områder med lite vegetasjon (høyfjellsområder) har terrengmodeller basert på bildematching fra flybilder med oppløsning 25 cm (omløpsfoto).
Ved laserskanning gjennom NDH-prosjektet og Geovekst er leveranse av genererte høydekurver med 1m ekvidistanse basert på terrengmodellene standard. 
For områder der terrengmodellen er basert på bildematching genereres høydekurver med 5m ekvidistanse. Disse kurvene forvaltes i FKB-Høydekurve. 
Gamle høydekurver basert på fotogrammetrisk datafangst kan fremdeles finnes i enkelte områder.

Ved større terrenginngrep anbefales det at det gjøres ny laserskanning og at FKB-Høydekurve oppdateres med bakgrunn i oppdaterte sensordata. I påvente av nye høydekurver anbefales det at man fjerner høydekurvene i områder der man vet at terrenget er endret slik at FKB-Høydekurve ikke gir feilaktig informasjon. 

For å få den mest detaljerte terrenginformasjonen bør terrengmodellene fra Høydedata.no brukes direkte og ikke de avleda høydekurvene i FKB. 


=== Uavhengige primærdatasett
FKB bygger i utgangspunktet på prinsippet om uavhengige primærdatasett. Med dette menes at primærdatasettene ikke er avledet fra andre datasett og ajourføres uavhengig av andre datasett. Hvert primærdatasett kan på denne måten leve atskilt fra andre datasett. Et objekt skal kun tilhøre ett primærdatasett.

Uavhengige primærdatasett er nyttig fordi de ulike datasettene vedlikeholdes av ulike instanser, til ulik tid og med ulike verktøy. Dette gir en effektiv dataforvaltning, men gir også muligheter for inkonsistens mellom datasettene. Det er derfor viktig at det kjøres konsistenskontroller mellom FKB-datasettene (og ev. andre datakilder).

*Merknad:* Prinsippet om uavhengige datasett blir ikke etterlevd fullt ut. Mange objekter forvaltes av praktiske/tekniske/organisatoriske årsaker i flere systemer. Dette er likevel et godt prinsipp for å få til effektiv dataforvaltning og som det bør være et mål å etterstrebe ved modellering og forvaltning av FKB-data.  

=== Identifikasjon av objekter i FKB

==== Unik identifikasjon av kartobjektene i FKB
Alle kartobjekter i FKB har en unik identifikator i form av datatypen _Identifikasjon_. Identifikasjon er en datatype som består av _navnerom_, _lokalid_ og _versjonid_. For FKB-data er _lokalid_ på formen UUID <<UUID>>. Dette innebærer at _lokalid_-en alene alltid er globalt unik. Identifikasjon er modellert som en del av fellesegenskapene i FKB. Se detaljer om dette under kapittel 7.

Logikken rundt identifisering og håndtering av unike objekter i FKB konsentrerer seg om håndtering av egenskapen _lokalid_. Ved bruk av FKB-data skal man forholde seg til _lokalid_ som den egenskapen som identifiserer hvert kartobjekt i FKB unikt. Både NGIS-OpenAPI og Geosynkronisering-API baserer seg på _lokalid_ til å identifisere transaksjoner på objekter i FKB. Når FKB-data utveksles på GML-format skal GML-id til objektene inneholde _lokalid_.

Det er vesentlig å presisere at identifikasjon på kartobjektene i FKB nettopp identifiserer et kartobjekt og _ikke_ det fysiske objektet som kartobjektet representerer. Det kan oppstå nye/endra kartobjekter som representerer det samme fysiske objektet og man bør derfor være forsiktig med å knytte informasjon om det fysiske objektet til den unike identifikatoren i FKB. I slike sammenhenger bør man i stedet benytte en tematisk identifikator som f.eks. bygningsnummer for objekttype Bygning.

*Regler for håndtering av lokalid:*

FKB inneholder mange typer data og det er vanskelig å lage detaljerte regler for håndtering av identifikasjon i forbindelse med geometrioperasjoner som gjelder generelt for FKB. Noen overordna føringer gjelder likevel:

* Nye kartobjekter: Det genereres en ny _lokalid_ til objektet
* Endring av et objekt (egenskaper og/eller geometri): _Lokalid_ beholdes (versjonid oppdateres). 
** Endring av objekttype på et objekt er et spesialtilfelle. Dette håndteres som at et objekt av den gamle objekttypen slettes og at et objekt av den nye objekttypen etableres (_lokalid_ beholdes ikke, se regler under). 
* Sletting av objekt: Objektet (inkl. _lokalid_) slettes. Nye objekter som oppstår skal ikke gjenbruke en _lokalid_ som allerede er brukt/slettet
* Splitting av et objekt: Håndteres som ett endret objekt (_lokalid_ beholdes) og ett nytt objekt (ny _lokalid_)
* Sammenføying av to objekter: Håndteres som ett endret objekt (_lokalid_ beholdes) og ett slettet objekt

Dersom det finnes egenskaper på kartobjektene som er knyttet til det fysiske objektet (f.eks. bygningsnummer i FKB-Bygning) så må det lages rutiner som sikrer at denne informasjonen tas vare på gjennom av alle typer endringer i kartobjektene. Den generelle transaksjonslogikken i FKB vil ikke automatisk håndtere dette. Les mer om dette under <<Koblingsnøkler til andre data>>. 

*_Alternativ håndtering av lokalid:_*

Det absolutte kravet i FKB er at situasjonen etter transaksjonen er komplett/riktig. I noen tilfeller er det lite hensiktsmessig/meningsfullt å beholde _lokalid_ ved splitting/sammenføying av objekter. Dette kan f.eks. være ved ajourhold av FKB-AR5 (eller andre datasett) der det er vanskelig å knytte et kartobjekt til et spesifikt objekt i terrenget. I slike tilfeller kan man velge en alternativ håndtering ved splitting/sammenføying:

* Splitting av objekt: Håndteres som ett slettet objekt og to nye objekter (to nye _lokalid-er_)
* Sammenføying av objekt: Håndteres som to slettinger og ett nytt objekt (en ny _lokalid_).


*Regler for håndtering av navnerom:*

* Navnerom identifiserer datasettet unikt og settes av forvaltningssystemet. Eks. http://data.geonorge.no/SFKB/FKB-Vann/so

*Regler for håndtering av versjonid:*

* Versjonid settes lik tidspunkt for oppdatering av objektet i forvaltningsbasen. Dette styres også automatisk av forvaltningssystmet. Versjonid er nøkkelen ved historiske spørringer mot FKB-data.
* I forvaltningsbasen vil versjonid ha lik verdi som oppdateringsdato. Les mer om dette under <<Oppdateringsdato>> 

Les mer om håndtering av identifikasjon i i forvaltningssystemet https://www.kartverket.no/geodataarbeid/ngis/teknisk-handbok[NGIS/Sentral FKB].


==== Koblingsnøkler til andre data

Datasettene i FKB inneholder noen koblingsnøkler til tilsvarende objekt i andre databaser. Dette gjøres ved at det legges en egenskapsverdi som unikt identifiserer det tilsvarende objektet i det eksterne systemet inn på kartobjektet i FKB. 

Koblingsnøkler til andre data gir mulighet til å koble FKB-data til andre typer data og gir brukeren vesentlig større nytteverdi. Å etablere koblingsnøkler slik som omtalt over kan være arbeidskrevende.  

Koblingsnøkler gir også muligheter for å utføre automatisk feilsjekking av FKB-dataene mot de eksterne dataene. Når dette blir gjort, oppdages en god del feil som må rettes. Ved å ta belastningen ved å rette opp feil vil data imidlertid gi vesentlig sikrere bruk i den daglige forvaltning. Koblingsnøkler som skal opprettes i FKB, er spesifisert under det enkelte datasett. 

Eksempel på godt etablerte koblinger fra FKB til andre systemer/databaser er:

* Kobling mellom representasjonspunkt i bygninger i FKB og Matrikkel (koblingsnøkkel er bygningsnummer - bygningens unike identifikasjon).
* Kobling mellom veglenker i vegnettet (Elveg 2.0) og FKB-TraktorvegSti og adressekode/navn i Matrikkelen (koblingsnøkkel er adressekode).


*Eksterne pekere som URI:*

Ved innføring av FKB 5.0 innføres mulighet for kobling mot andre systemer i form av URI-er <<#URI>> for en rekke nye objekttyper. Eksempler på dette er:

* nvdbpeker - egenskap der man kan legge inn en URI som peker på et unikt objekt i NVBD 
* nrlpeker - egenskap der man kan legge inn en URI som peker på et unikt objekt i NRL 
* eksternpeker - egenskap der man kan legge inn en URI som peker på et unikt objekt i et eksternt system (angitt av URI-en)

Det er ikke et krav om at URI-en skal peke til en åpen tjeneste som gir en presentasjon av objektet i det eksterne systemet, men bruken av URI-er åpner for at dette er mulig.


=== Bruk av datoegenskaper 
Fellesegenskapene for FKB definerer hvilke datoegenskaper som skal benyttes i FKB. Se kapittel 7 for detaljer i hvordan det er modellert. Dette kapittelet beskriver  detaljer for den praktiske bruken av datoegenskapene.

==== Datafangstdato
Datafangstdato angir dato for måling/observering/registrering av objektet (i terrenget).

* Ved fotogrammetrisk datafangst vil dette være datoen for når flybildene som ligger til grunn for kartkonstruksjonen ble tatt (flyfotodato).
* Ved digitalisering av eksisterende kart vil dette normalt være datoen for når flybildene kartene er produsert etter er tatt (flyfotodato).
* Ved landmåling vil dette være datoen for innmåling.

*Ukjent dato:* Datafangstdato er påkrevd på alle objekter. For en del eldre data kan det være at objektene ikke er kodet med noen dato. Som dummyverdi for FKB-data skal 18000101 benyttes.

==== Verifiseringsdato 
Verifiseringsdato angir dato for når det er fastslått at eksisterende dataobjekt fremdeles samsvarer med objektet i virkeligheten. Egenskapen brukes f.eks. i forbindelse med fotogrammetrisk ajourhold, og hvor det ikke er registrert endringer på objektet (det virkelige objektet er i samsvar med dataobjektet).

==== Oppdateringsdato
Oppdateringsdato er tidspunkt for oppdatering i forvaltningssystemet. Dette er en verdi som styres automatisk av forvaltningssystemet etter følgende regler:

. Oppdateringsdato er datotid for oppdatering av databasen settes av forvaltningsbasen (ikke av klienten). For data i Sentral FKB vil verdien for oppdateringsdato samsvare med versjonid.
. Oppdateringsdato skal endres også hvis det er kopidata som blir endret eller importert i en ”kopibase”. I en kopibase vil altså oppdateringsdato være oppdatert, mens versjonid fortsatt skal ha en verdi som beskriver tidspunkt for oppdatering i forvaltningsbasen.
. Når avgrensingslinjene til en flate endres, skal flateobjektet få ny oppdateringsdato.
. Oppdateringsdato skal endres hvis en egenskap endres.

==== Sluttdato
Sluttdato er tidspunkt for når versjonen av objektet ble erstattet eller opphørte å eksistere. Egenskapen styres av forvaltningssystemet. Sluttdato sendes bare med ut fra forvaltningssystemet ved historiske spørringer. For levende data vil ikke sluttdato ha noen verdi og egenskapen skal da heller ikke sendes med.


==== Praktisk bruk av datoegenskapene i forbindelse med ajourhold av FKB-data
Ved fotogrammetrisk ajourføring blir noen objekter registrert på nytt, noen får endret databeskrivelse, noen slettes, mens andre forblir uforandret. For påføring av de ulike datoegenskapene gjelder følgende ved en fullstendig fotogrammetrisk ajourføring:

. Nye dataobjekter skal ha påført ny _DATAFANGSTDATO_ (=flyfotodato for bildene som ligger til grunn for kartkonstruksjon).
. Dataobjekter som fantes fra før i datasettet og det gjennom visuell inspeksjon blir verifisert at objektene fortsatt eksisterer uforandret i terrenget, skal beholde gammel _DATAFANGSTDATO_. I tillegg skal ny _VERIFISERINGSDATO_ legges på objektet. Dette selv om man ikke har kontrollert at egenskapskodingen av objektet er riktig. Dersom det er dataobjekter som ikke synes i bildene, for eksempel på grunn av gjengroing, skygge i bildene eller overdekking, må det utøves skjønn. Enten vurderes det at dataobjektet fremdeles eksisterer uforandret (kodes som over) eller at det er borte (slettes). Dersom man er i stor tvil, skal dataobjektet beholdes uten påføring av verifiseringsdato.
. Endrede dataobjekter skal ha påført ny _DATAFANGSTDATO_ (=flyfotodato for bildene som ligger til grunn for endringen). Dersom det kun er deler av et objekt som er endret, splittes dataobjektet. Det samme gjelder for objekter som krysser prosjektavgrensningen. Den delen som er uforandret beholder _DATAFANGSTDATO_, men det settes på ny _VERIFISERINGSDATO._ Den delen av objektet som er endret får kun ny _DATAFANGSTDATO_.
. Sletting av dataobjekter. Når objektet ikke fins i terrenget lenger, eller det vurderes til å ha blitt borte, skal det slettes fra FKB. I ajourholdsprosjekter vil det være en god ide å levere slettede objekter til oppdragsgiver. Typisk kan dette gjelde bygninger som ikke er merket som revet/brent, flyttet eller utgått i Matrikkelen.

[[fig-datering_eksempel]]
.Eksempel på datering av objekter ved fotogrammetrisk ajourføring
image::figurer/datering_eksempel.png[alt="Figur som viser eksempel på bruk av datafangstdato og verifiseringsdato på FKB-data"]

=== Kodelister
Alle kodelister i FKB 5.0 forvaltes i https://register.geonorge.no/sosi-kodelister/fkb[Geonorge kodelisteregister]. I UML-modellene ligger tomme kodelister med referanse (URL) til kodelistene i Geonorge. Dette innebærer at kodelistene i FKB kan endres uten at versjonsnummer på produktspesifikasjonene oppdateres. Systemer som forholder seg til FKB datamodellene må også forholde seg til Geonorge kodelisteregister.

Alle kodelister i Geonorge kodelisteregister inneholder 3 verdier: kodenavn, beskrivelse/definisjon og kodeverdi. Det er kodeverdiene som utveksles i dataene i alle formater, mens kodenavn og beskrivelse vil være det som presenteres for brukerne i de fleste tilfeller. 

*Retningslinjene for utforming av kodeverdier i FKB 5.0:*

* Kodeverdiene må være unike og teknisk enkle å utveksle/tolke. Det innebærer at norske tegn, skilletegn (bindestrek/underscore/mellomrom) og andre spesialtegn unngås. Som hovedregel brukes små bokstaver og ved sammensatte kodeverdier brukes stor bokstav på andre ledd ("NCName")
* Kodeverdiene skal være kortest mulig (normalt under 10 tegn) 
* Kodeverdiene skal om mulig gi en intuitiv mening (en forkortet/sammentrekt versjon av kodenavn e.l.)
* Etablerte kodeverdier (f.eks. i form av tallverdier) fra tidligere versjoner av FKB eller andre systemer som NVDB/Matrikkelen beholdes

*Statuskoder i Geonorge kodelistergister:*

* Status _Gyldig_: Brukes for gyldige koder i FKB. Kun kodeverdier med status _Gyldig_ skal brukes ved oppdateringer inn i FKB
* Status _Utgått_ og _Erstattet_: Brukes for koder som ikke lenger skal benyttes ved oppdateringer i FKB. Det kan likevel være mulig at eldre FKB-data har disse kodene.
* Status _Sendt inn_, _Ikke godkjent_ og _Utkast_: Brukes for koder som er foreslått brukt i FKB, men disse skal ikke benyttes før status ev. endres til _Gyldig_. 


=== Vedlikehold
Hovedprinsippet for ajourføring av FKB-data er at utvalgte objekter og datasett skal ajourføres kontinuerlig gjennom daglige administrative rutiner, for eksempel byggesaksbehandling, eller ved rapportering fra samarbeidspartene. Fullstendighet og hurtig oppdatering av de viktigste objektene skal prioriteres fremfor stedfestingsnøyaktighet. Dette betyr at stedfestingsnøyaktighet i enkelte tilfeller kan bli dårligere enn kravet til aktuell FKB-standard. Det er imidlertid et krav at alle aktuelle objekter skal være kodet med opplysninger om datafangstmetode og stedfestingsnøyaktighet (..KVALITET).

Alle endringer vil ikke bli fanget opp gjennom administrative rutiner, og det vil derfor være nødvendig med periodisk ajourføring, der hele datasettet gjennomgås og bringes opp på et ajourført nivå tilsvarende som ved nykartlegging. Ved periodisk ajourføring skal data fra kontinuerlig ajourføring kontrolleres, eventuelt forbedres, manglende objekter skal suppleres og overskytende objekter skal slettes. Objekter som ikke er endret, blir ikke kartlagt på nytt. Hyppigheten av periodisk ajourhold varierer avhengig av områdetype og byggeaktivitet.

[[fig-fkb_ajourforing]]
.De 2 hovedprosessene for ajourføring av FKB-data. 
image::figurer/ajourforing_prinsipper.png[alt="Figur som viser oppdatering av FKB gjennom kontinuerlig og periodisk ajourhold"]

For mer informasjon om ajourføring av FKB-data henvises det til veilederen til standarden Produksjon av basis geodata <<#PABG>> og Geovekst veiledningsdokumentasjon <<#GEO-VEIL>>. Det henvises også til spesifikasjonen av datasettet FKB-Tiltak som handler om å fange opp objekter i kontinuerlig ajourhold gjennom saksbehandling.
	

=== Oppgradering
Med oppgradering menes forbedring av den datatekniske kvaliteten av eksisterende data. 

Ved utgivelse av nye versjoner av Produktspesifikasjon for FKB må det vurderes i det enkelte tilfelle om og hvordan eldre FKB-data skal oppgraderes. Dette vil ofte være et økonomisk spørsmål. Data skal som minimum oppgraderes slik at de er kodet i henhold til gjeldende versjon av FKB. Eventuelle mangler i forhold til gjeldende versjon av FKB skal lagres som metadata.

Oppgradering av eldre FKB-data kan deles inn i tre hovedgrupper.

. *Oppdatering av koder til ny SOSI/FKB-versjon*.
Objekttyper og egenskaper skal omkodes til gjeldende versjon av SOSI/FKB. I en del tilfeller der man har eldre data kan det være aktuelt å ikke oppgradere dataene slik at de følger alle topologiske regler som er spesifisert i FKB.

. *Oppgradering av FKB-data fra 2 dimensjoner til 3 dimensjoner* (med høyde).
For data på terrenget som mangler høyde vil det være interessant å påføre høydeverdier fra terrengmodell. Dette kan gjøres i egne oppgraderingsprosjekter eller i forbindelse med periodisk ajourføring. 

. *Konsistens mellom datasett*. 
Enkelte FKB-data skal være koblet mot registerdatabaser. Forbedring av disse koblingene er aktuelt å gjøre som egne oppgraderingsjobber. Eksempel på en slik oppgraderingsjobb er ”husvask”. I ”husvask” kontrolleres at bygningspunkt i Matrikkel ligger inne i bygningskroppen. 


=== Sømløse data

*Mellom kommuner eller fylker:*

FKB-data forvaltes i Sentral FKB. Prinsippet er at forvaltningsløsningen er satt opp mest mulig sømløs, men praktiske hensyn gjøre at noen datasett likevel er delt i kommunevise eller fylkesvise baser. Alle datasett er delt i sondedeler slik at kommunene oppdaterer direkte i sin lokale UTM-sone. 

Ved deling i forskjellige forvaltningsbaser er det gjeldende administrative grense som brukes til avgrensning. 

[[fig-fkb_somlos]]
.Eksempel på data fra to nabokommuner der man ikke har forvaltet dataene etter et felles forvaltningsområde. Kommunegrensen er tegnet med svart tykk stiplet linje.
image::figurer/somloshet.png[alt="Figur som viser problemer med gap/overlapp grunnet manglende sømløshet"]

*Mellom områdetyper/kartleggingsstandarder:*

Forvaltningen skjer sømløst mellom kartleggingsstandardene (A-D). Det er kun kvalitetskodingen som angir at data har ulik stedfestingsnøyaktighet. Det er metadataregisteret Georef som angir gjeldende kartleggingsstandard. Georef er tilgjengelig som WMS-tjeneste, se informasjon på geonorge.no.

<<<

== Modellering av FKB produktspesifikasjoner

FKB 5.0 skal generelt modelleres i henhold til reglene i SOSI Regler for UML-modellering versjon 5.1 <<SOSI-UML>>. I tillegg er det gjort noen presiseringer/innsnevringer for FKB som er beskrevet i dette kapittelet. FKB Generell del inneholder felles modelleringselementer (kodelister, datatyper og fellesegenskaper) som realiseres i de enkelte FKB produktspesifikasjonene.

=== Geometrimodell i FKB

==== Geometrityper

[[tab-geometrityper]]
.Tabell over hvilke geometrityper som kan benyttes i FKB 5.0 i UML-modellene og forskjellige formater
[cols="4*", options="header"]
|===
|UML (ISO 19107)
|SOSI Geometri
|GML Geometri
|JSON Geometri

|GM_Point
|.PUNKT
|gml:Point
|point

|GM_Curve
|.KURVE
|gml:Curve
|linestring

|GM_Surface
|.FLATE
|gml:Surface
|polygon
|===

FKB-data skal ha en enklest mulig geometri. Andre geometrityper enn de som er angitt i tabellen over (som f.eks. multipoint, multicurve, multisurface etc.) skal ikke benyttes i FKB 5.1. 

==== Flere geometrier

Hovedregel i FKB produktspesifikasjoner er at hver objekttype modelleres med _en_ geometriegenskap. Det finnes imidlertid noen unntak fra denne hovedregelen. Se tabell under for mulige kombinasjoner av geometriegenskaper for objekttyper som er definert med mer enn _en_ geometriegenskap i FKB:

[[tab-multippel_geometri]]
.Tabell over hvilke kombinasjoner av geometrityper som kan benyttes som multippel geometri i FKB 5.1
[cols="3*", options="header"]
|===
|Kombinasjon av geometriegenskaper
|Beskrivelse
|Eksempel

|Påkrevd flategeometri og opsjonell punktgeometri 
|Brukes for objekttyper med flategeometri for å gi mulighet til å utveksle representasjonspunkt for flategeometrien. Anbefales kun brukt der representasjonspunktet har en mening/funksjon.
|Objtype Arealressursflate

|Påkrevd punktgeometri og opsjonell flategeometri 
|Brukes for objekttyper som alltid vil ha punktgeometri, men som også kan ha flaterepresentasjon. 
|Objtype Bygning

|Opsjonell punktgeometri og opsjonell flategeometri (og en constraint som sier at _en_ av dem skal finnes)
|Brukes for objekttyper som det i noen sammenhenger er naturlig å representere som punkt og i andre sammenhenger som flate (ut fra størrelse/detaljering etc). 
|Objtype Pipe

|===

I alle disse kombinasjonene vil det være et krav om at punktgeometrien ligger innenfor flategeometrien. I GML-formatet vil disse dataene utveksles med flere geometriegenskaper. I SOSI-formatet vil de bare ha en geometri. Enten punktgeometri eller flategeometri - der punktgeometrien utveksles som representasjonspunkt i flaten.


==== Assosiasjoner
Kartobjektene i FKB er alltid selvstendige objekter som kan eksistere uavhengig av andre objekter. Assosiasjoner uttrykker generelt en eller annen sammenheng mellom to objekttyper/objekter. Et eksempel på dette kan være å uttrykke hvilke Veranda-objekter som tilhører hvilke Bygning-objekter. FKB 5.1 åpner for å benytte assosiasjoner i datamodellene etter følgende rammer:

* Assosiasjoner modelleres som vanlige assosiasjoner i tråd med reglene i SOSI Regler for UML-modellering 5.1 <<SOSI-UML>>. Andre varianter av assosiasjoner som _aggregering_, _komposisjon_ etc. benyttes ikke i FKB.
* Assosiasjoner i FKB skal alltid modelleres mellom konkrete/instansierbare objekttyper (og altså ikke til/fra supertyper). Dette gjør det enklere å implementere assosiasjonene som koblingstabeller i geografiske databaser. 
* Assosiasjoner i FKB modelleres som hovedregel som _enveis_. Det vil si at de bare er navigerbare i en retning. (Eks: Bygningen vet hvilke verandaer som hører til bygget, men verandaen vet ikke hvilken bygning den tilhører)
* Multiplisitet på den navigerbare enden skal alltid være 0..1 eller 0..*. (Dvs. at det at det finnes et objekt av en objekttype vil ikke medføre krav om at det må finnes et referert objekt av en annen type.)
* Assosiasjonene modelleres slik at det settes krav til at de assosierte objektene utveksles som refererte objekter i GML (dvs. ved bruk av taggen _inlineOrByReference=byReference_ i UML) 
* Dersom det benyttes assosiasjoner som er navigerbare i begge retninger så skal det være multiplisitet 0..1 i begge ender. (Dvs. at _mange-til_mange_-forhold unngås i FKB datamodeller) 

Se eksempler på <<Utveksling av assosiasjoner>> på GML- og SOSI-format i Vedlegg C.

Hvilke avgrensningskurver som brukes til å avgrense et flateobjekt er en spesialvariant av assosiasjoner med egne krav. Dette er beskrevet nærmere under <<Modellering av flateobjekter>> 


==== Flategeometri

===== To typer flateobjekter

Objekttyper i FKB med flategeometri deles i 2 typer:

[[tab-flategeometri]]
.Oversikt over de 2 typene flateobjekttyper som finnes i FKB
[cols="4*", options="header"]
|===
|Type
|Beskrivelse
|Flatereferanser
|Eksempel

|1
|Der avgrensningsobjektene ikke har noen funksjon utover å avgrense flateobjektene ("simple-feature" flater)
|Ingen avgrensningsobjekter, ingen flatereferanser ("heleid geometri")
|Objekttype Brønn, Objekttype Industriområde

|2
|Der det finnes egne avgrensningsobjekter og det er krav til sammenheng mellom flateobjektene og avgrensningsobjektene 
|Flateobjektet vet hvilke avgrensningsobjekter som utgjør flateavgrensningen og retning og rekkefølge på disse objektene ("delt geometri")
|Objtype Bygning, Objtype Elv
|===

===== Modellering av flateobjekter

Hvilken av de 2 typene flater en objekttype er må man ta stilling til når man utarbeider FKB produktspesifikasjonen.

[[fig-flategeometri]]
.Mal for UML-modellering av objekttyper med flategeometri. "Type 1" til venstre og "Type 2" til høyre
image::figurer/flategeometri_modell.png[]

Det er lov (men ikke anbefalt) å modellere med opsjonell punktgeometri i tillegg til flategeometrien for å kunne utveksle representasjonspunkt for flater. Dette gjelder flater av både "Type 1" og "Type 2". 

Dersom man skal modellere en objekttype av "Type 2" (med krav til sammenheng mellom flateobjekt og avgrensningsobjekter) gjelder følgende regler ved UML-modelleringen:

. Det etableres en assosiasjon fra flateobjekttype (_kilde_) til avgrensningsobjekttype (_mål_)
. Assosiasjonen skal være navigerbar fra _kilde_ til _mål_ (se pil i figuren over) 
. Assosiasjonen skal ha mulitiplisitet _null-til-mange_ på _mål_-siden av assosiasjonen
. Assosiasjonen skal ha rollenavn som starter med _avgrensesAv_ på _mål_-siden (rollenavnene må være unike pr. flateobjekttype så dersom en flateobjekttype kan avgrenses av flere typer avgrensningsobjekter så legges avgrensningsobjekttype som postfiks i rollenavnet for å gjøre det unikt)
. Flateobjekttypen skal ha restriksjon med denne beskrivelsen: "_Område-geometrien skal være lik summen av geometriene til de assosierte avgrensningsobjektene_"

Se eksempler på <<Utveksling av flategeometri>> på GML- og SOSI-format i Vedlegg C.

=== UML felleselementer til bruk i «ApplicationSchema» for FKB-datasett
Generelle klasser med fellesegenskaper som kan kopieres inn og benyttes i FKB produktspesifikasjoner.


include::EA_eksport_ny.adoc[]


<<<

== Kvalitet

=== Kvalitet på FKB-data
FKB data oppdateres gjennom forskjellige prosesser og det er et overordnet prinsipp at fullstendighet 
prioriteres framfor homogen stedfestingsnøyaktighet. FKB-data er en blanding av data med ulike datakilder og 
kvalitet. Et resultat av dette er at det er vanskelig å garantere stedfestingsnøyaktigheten til FKB-data 
innenfor et område. For å ha full kontroll på kvaliteten på FKB-dataene i en leveranse må man derfor 
se på kvalitetskodingen (metadata) på det enkelte objekt. Kravene til kvalitet på FKB settes ved datafangst. 

Fotogrammetri er fortsatt den dominerende datakilden. For de fleste FKB-datasett har over 99% av kartobjektene fotogrammetri som datafangsmetode. Ved fotogrammetrisk datafangst settes det klare krav til kvaliteten og det utføres kontroll. Ambisjonen er at FKB-dataene skal ha en så god og homogen kvalitet som mulig og det jobbes for å sette tilsvarende krav til dataene også ved andre typer datafangst.

=== Kvalitetselementer som benyttes for å sette krav til FKB-data
I dette avsnittet er det angitt hvilke kvalitetselementer som skal benyttes i spesifikasjoner for 
datafangst av FKB-data. Kvalitetselementene er hentet fra Geodatakvalitet <<#G>> og det henvises til 
denne standarden for nærmere beskrivelse av de ulike kvalitetselementene og kvalitetsmålene, og for 
prinsipper for kontroll av kravene i en leveranse.

I enkelte sammenhenger kan det også være behov for å sette krav til FKB-dataene som ikke lar seg 
beskrive av kvalitetsmålene som er definert i Geodatakvalitet. I slike sammenhenger må det i såfall
utarbeides egne kvalitetsmål (dvs. beskrives detaljert hva kravet går ut på og hvordan det skal 
kontrolleres). Dette kan være spesifikke krav til topologisk konsistens eller lignende.

I FKB er det kun kvalitetselementet stedfestingsnøyaktighet med tilhørende datafangstmetode, samt 
datering som obligatorisk skal ligge i selve dataene. Informasjon om øvrige kvalitetselementer vil 
normalt finnes i kontrollrapporter for det enkelte kartleggingsprosjekt eller som metadatainformasjon.

[[tab-Stedfestingsnoyaktighet]]
.Kategori: Stedfestingsnøyaktighet
[cols="3*", options="header"]
|===
|Kvalitetselement
|Kvalitetsmål
|Referanse

|Grunnrissnøyaktighet
|Grove feil (%)
|Geodatakvalitet:2014/301/1

|Grunnrissnøyaktighet
|Systematiske feil (m)
|Geodatakvalitet:2014/303/1

|Grunnrissnøyaktighet
|Standardavvik (m)
|Geodatakvalitet:2014/304/1

|høydenøyaktighet
|Grove feil (%)
|Geodatakvalitet:2014/301/1

|høydenøyaktighet
|Systematiske feil (m)
|Geodatakvalitet:2014/302/1

|høydenøyaktighet
|Standardavvik (m)
|Geodatakvalitet:2014/304/1
|===

Ved kontroll av stedfestingsnøyaktighet må man alltid kontrollere både standardavvik, systematiske
avvik og andel grove feil mot en fasit <<#G>>. 

[[tab-Logisk-konsistens]]
.Kategori: Logisk konsistens
[cols="4*", options="header"]
|===
|Kvalitetselement
|Kvalitetsmål
|Referanse
|Kommentar

|Domenekonsistens
|Antall enheter som ikke er i samsvar med domenet
|NS-EN ISO19157:2013/016/1 
| Objekttyper, egenskaper og egenskapsverdier skal være i tråd med datamodellen. Kontrolleres f.eks. ved GML-validering eller SOSI-kontroll

|Konseptuell konsistens
|Antall enheter der regler i konseptuelt skjema ikke er oppfylt
|NS-EN ISO19157:2013/010/1 
|Må spesifiseres nærmere hvilke krav i det konseptuelle skjemaet som skal 
oppfylles dersom kvalitetsmålet skal benyttes.

|Topologisk konsistens
|Antall ulovlige løse ender
|Geodatakvalitet:2014/201/1 
|Må spesifiseres nærmere hva som regnes som en ulovlig løs ende dersom kvalitetsmålet skal benyttes

|Topologisk konsistens
|Antall feil i lenkekryssing
|Geodatakvalitet:2014/202/1 
|Må spesifiseres nærmere hvilke typer lenkekryssinger som regnes som feil dersom kvalitetsmålet skal benyttes

|Topologisk konsistens
|Antall ulovlige egenoverlappinger
|NS-EN ISO19157:2013/027/1
|Kvalitetsmål som generelt kan settes til objekter med kurvegeometri

|Topologisk konsistens
|Antall ulovlige egenkryssinger
|NS-EN ISO19157:2013/026/1
|Kvalitetsmål som kan settes til objekter med kurvegeometri som inngår i flateavgrensninger

|Topologisk konsistens
|Antall ulovlige småpolygoner
|NS-EN ISO19157:2013/025/1
|Må spesifiseres nærmere hvilke typer småpolygoner som regnes som feil dersom kvalitetsmålet skal benyttes

|Topologisk konsistens
|Prosentandel feil på fulldekkende flater
|Geodatakvalitet:2014/204/1
|Kvalitetsmål som er aktuelt på objekttyper som skal utgjøre en heldekkende flate i et område
|===
For alle kvalitetsmål som måler «antall avvik» på logisk konsistens er det naturlig at kravet settes til 0 dersom kvalitetsmålet anvendes.


[[tab-Egenskapskonsistens]]
.Kategori: Egenskapskonsistens
[cols="3*", options="header"]
|===
|Kvalitetselement
|Kvalitetsmål
|Referanse

|Klassifikasjonsriktighet
|Prosentandel feil klassifiserte egenskaper
|Geodatakvalitet:2014/508/1
|===


[[tab-Fullstendighet]]
.Kategori: Fullstendighet
[cols="3*", options="header"]
|===
|Kvalitetselement
|Kvalitetsmål
|Referanse

|Manglende objekter
|Prosentandel manglende objekter
|Geodatakvalitet:2014/102/1

|Overskytende objekter
|Prosentandel overskytende objekter
|Geodatakvalitet:2014/101/1
|===

Når man setter krav til datakvalitet i fotogrammetrisk registreringsinstruks og andre spesifikasjoner for datafangst av FKB-data skal det alltid settes krav til stedfestingskvalitet, egenskapskvalitet og fullstendighet ved hjelp av *alle* kvalitetsmålene som er definert i tabellene over. For logisk konsistens er flere av kvalitetsmålene av en slik natur at det må spesifiseres nærmere hvilke typer situasjoner som regnes som et avvik. Her må det gjøres et valg av hvilke kvalitetsmål som skal anvendes og ev. en nærmere spesifisering av hva som ligger i kravene i den enkelt spesifikasjon.

=== Krav til stedfestingsnøyaktighet - inndeling i klasser
For å angi krav til stedfestingsnøyaktighet er det definert fire klasser som objekttypene er inndelt i. Inndelingen i klasser bygger på hvor skarpt objekttypen er definert i terrenget. Denne inndelingen i nøyaktighetsklasser benyttes gjennomgående for alle datasett som inngår i fotogrammetrisk FKB og kan også anvendes som utgangspunkt for å sette krav til innsamling av FKB-data med andre metoder. For å få en oversikt over hvilke krav som gjelder for ulike objekttyper henvises det til spesifikasjonen av det enkelte FKB-datasett. 

include::../felles/tabell_noyaktighetsklasser.adoc[]

I tidligere versjoner av FKB har det ikke blitt definert egne krav til systematiske avvik. Det har i stedet blitt beskrevet at «systematiske avvik ikke skal trekkes fra ved beregning av standardavvik» noe som avviker fra definisjonen av standardavvik. Tidligere bruk av «standardavvik» i FKB har lignet mer på begrepet RMS etter definisjon i Geodatakvalitet.  

For å kunne følge standarden Geodatakvalitet fullt ut ved kontroll av data innføres fra FKB 5.1 eksplisitte krav til både systematiske avvik og standardavvik (se tabell 5). Kravene til systematiske avvik er satt slik at de maksimalt er 1/3 av krav til standardavvik. Kravene til systematisk avvik er basert på erfaringstall, samt at det sikrer at det systematiske avviket bare vil utgjøre en liten andel av det totale avviket mellom sann posisjon og målt posisjon. Kravet til standardavvik brukes derfor alene som et mål på dataenes nøyaktighet i metadataene.  

*Krav til grove feil*

Grove feil regnes som avvik større enn 3 ganger krav til standardavviket angitt i tabellen over. Kravet vil vanligvis være maksimalt 1 % grove feil, men kan variere for ulike objekttyper og angis i den enkelte FKB produktspesifikasjon.  

=== Avvik funnet ved kontroll av FKB-data

Produktspesifikasjon https://register.geonorge.no/produktspesifikasjoner/avvikkartdata[AvvikKartdata 1.0] spesifiserer hvordan avvik på kartdata skal utveksles. I forbindelse med utveksling av avvik knyttet til FKB-data i FKB-Kartleggingsprosjekter eller andre sammenhenger skal denne produktspesifikasjonen legges til grunn.

<<<

[appendix]
== Utvekslingsformater for FKB-data

FKB 5.1 er laget spesielt med tanke på utveksling på GML-format <<SOSI-GML>> og SOSI-format <<SOSI-FORMAT>>. Alle FKB 5.1-data kan konverteres fram og tilbake mellom SOSI-format og GML-format uten at man mister informasjon. 

I tillegg er _ESRI fgdb_ et populært format for filbasert distribusjon gjennom geonorge og _JSON_ <<JSON>> er et populært format ved jobbing mot Sentral FKB med NGIS-OpenAPI <<NGIS>>. For _ESRI fgdb_ og _JSON_-formatene finnes det ikke standarder som beskriver krav til utvekslingsformatet i detalj. 

=== Leveranseformater ved distribusjon fra Geonorge

[[tab-leveranseformat]]
.Liste over tilgjengelige filformater for nedlasting av FKB-data fra Geonorge.no
[cols="5*", options="header"]
|===
|Format
|Inndeling
|Koordinatsystem
|Tegnsett
|Språk

|GML 3.2.1
|Kommunevise filer
|Euref89 UTM33 + lokal UTM-sone
|UTF-8
|nor

|SOSI-format 5.0
|Kommunevise filer
|Euref89 UTM33 + lokal UTM-sone
|UTF-8
|nor


|ESRI fgdb
|Kommunevise filer
|Euref89 UTM33 + lokal UTM-sone
|UTF-8
|nor

|ESRI fgdb
|Landsdekkende + fylkesvise filer
|Euref89 UTM33 
|UTF-8
|nor
|===

=== Formater i NGIS-OpenAPI
NGIS-OpenAPI er det nye og fleksible API-et for oppdatering av (blant annet) FKB-data <<NGIS>>. 

I NGIS-OpenAPI benyttes enten GML-format eller JSON-format for dataoverføring. GML-formatet er på samme måte som GML-filer ved distribusjon gitt av GML-Schema for produktspesifikasjonene og pakkes inn i WFS-T transaksjoner <<WFS>>. Dette er samme type dataformat som også brukes i Geosynkronisering-API.

Alternativt kan JSON-format benyttes i NGIS-OpenAPI. Dette formatet er basert på https://datatracker.ietf.org/doc/html/rfc7946[GeoJSON RFC 7946, august 2016] med utvidelser. Et programbibliotek som kan tolke GeoJSON vil også kunne lese dataene som utveksles med NGIS-OpenAPI, men vil ikke uten videre kunne tolke innholdet i utvidelsene. Utvidelsene brukes til f.eks. å utveksle informasjon om assosiasjoner, flatereferanser ved delt geometri og _action_ ved oppdateringer (insert/replace/erase). Se https://github.com/kartverket/SFKB-API[dokumentasjon av NGIS-OpenAPI] for eksempler på filformat ved bruk av API-et. 

<<<

[appendix]
== Romlige referansesystem

FKB-data er detaljerte data med høy presisjon. Dette betyr at man må være bevisst på ev. feil som kan innføres ved transformasjon av dataene mellom forskjellige romlige referansesystemer. 
I forvaltningen av FKB-data gjøres vanligvis oppdateringen direkte i den aktuelle kommunens koordinatsystem slik at man unngår transformasjon av data. 
Kommuner i Finnmark fylke har EUREF89 UTM35 som lokal sone. Kommuner i Nordland og Troms har EUREF89 UTM33 som lokal sone, mens kommuner fra Trøndelag og sørover bruker EUREF89 UTM32 som lokal sone. 

Dersom det skal tillates oppdatering med transformasjon inn i FKB-dataene må det benyttes en transformasjon som gir presisjon bedre enn oppløsningen i FKB-dataene (i praksis bedre en ca 5 mm).

[[tab-referansesystem]]
.Liste over romlige referansesystem som benyttes i forvaltningen av FKB
[cols="3*", options="header"]
|===
|Referansesystem
|EPSG-kode (GML/JSON-format)
|SOSI-kode (SOSI-format)

|https://register.geonorge.no/epsg-koder/euref89-utm-sone-32-2d[EUREF89 UTM32 (2d)]
|25832
|Koordsys 22, Vert-datum ikke angitt

|https://register.geonorge.no/epsg-koder/euref89-utm-sone-33-2d[EUREF89 UTM33 (2d)]
|25833
|Koordsys 23, Vert-datum ikke angitt

|https://register.geonorge.no/epsg-koder/euref89-utm-sone-35-2d[EUREF89 UTM35 (2d)]
|25835
|Koordsys 25, Vert-datum ikke angitt

|https://register.geonorge.no/epsg-koder/euref89-utm-sone-32-2d-nn2000[EUREF89 UTM32 + NN2000]
|5972
|Koordsys 22, Vert-datum NN2000

|https://register.geonorge.no/epsg-koder/euref89-utm-sone-33-2d-nn2000[EUREF89 UTM33 + NN2000]
|5973
|Koordsys 23, Vert-datum NN2000

|https://register.geonorge.no/epsg-koder/euref89-utm-sone-35-2d-nn2000[EUREF89 UTM35 + NN2000]
|5975
|Koordsys 25, Vert-datum NN2000
|===

Ved distribusjon kan dataene transformeres til en rekke andre referansesystemer ved help av standard transformasjonsbiblioteker.

<<<

[appendix]
== Assosiasjoner og flategeometri på SOSI- og GML-format
Generelt gjelder SOSI del 1 Realisering av GML-format 5.0 <<SOSI-GML>> og Realisering av SOSI-format 5.0 <<SOSI-FORMAT>> ved utveksling av FKB-data. 
I FKB 5.0 ble  <<Assosiasjoner>> og endringer i håndtering av <<Flategeometri>> innført. Dette vedlegget inneholder detaljer om hvordan dette skal utveksles på SOSI- og GML-format inkludert korte eksempler.


=== Utveksling av assosiasjoner

==== SOSI-format
I SOSI-formatet utveksles assosiasjoner med referanser til SOSI-gruppenummer (altså kun unikt innenfor SOSI-fila). 

.Eksempel på assosiasjon på SOSI-format. Referanse fra Maste-objekt til SOSI-gruppenummer for Bardun-objekt ("..BARDUN :1").
[example]
[source,sosi]
include::eksempel/assosiasjon_sosi.txt[indent=2]

==== GML-format
I GML-formatet utveksles assosiasjoner med mekanismen _xlink:href_ på objektet det pekes fra til GML-Id på objektet det pekes til. GML-Id skal i FKB utformes etter konvensjonen «objekttypenavn_lokalid» slik at denne er unik/meningsfull også på utsiden av GML-fila. 

.Eksempel på assosiasjon på GML-format. Referanse fra Maste-objekt til GML-id for Bardun-objekt ("<app:bardun xlink:href="#Bardun_5e1d42bb-fd1c-4a58-92dc-aa0b3fadf57d" />")
[example]
[source,xml]
include::eksempel/assosiasjon_gml.xml[]


=== Utveksling av flategeometri 

==== SOSI-format

SOSI-formatet er bygget opp med referanser til avgrensningsobjektene i stedet for at flateobjektene inneholder selve geometrien. Flater med delt geometri ("Type 2") kan derfor utveksles som tradisjonelle SOSI .FLATE-objekter med flatereferanser (.REF). Om man ønsker å utveksle flater med heleid geometri ("Type 1") i SOSI så skal man etablere et "hjelpeobjekt" i form av en .KURVE-gruppe med objekttype _Flateavgrensning_ (som ikke har noen identifikasjon/lokalid) som inneholder hele flateavgrensningen og refereres fra .FLATE-objektet. Dersom "Type 1"-flaten inneholder øyer/hull må det etableres egne _Flateavgrensning_ SOSI-grupper også for disse som referes som hull etter vanlige regler for SOSI-formatet.

.Eksempel på heleid flate på SOSI-format. Avgrensningsgeometrien for flata ligger i et eget Flateavgrensning-objekt (uten identifikasjon) som refereres fra flate-objektet. Flateobjektet i eksempelet har representasjonspunkt.
[example]
[source,sosi]
include::eksempel/flate_sosi.txt[indent=2]

.Eksempel på flate med delt geometri på SOSI-format. Flate-objektet inneholder kun representasjonspunkt og referanse til avgrensningsobjektene ("..REF :2 :-3")
[example]
[source,sosi]
include::eksempel/flate_delt_sosi.txt[indent=2]

==== GML-format

En "Type 1" flate vil i GML være rett fram å utveksle som en gml:Surface med heleid geometri. Om man skal utveksle en flate av "Type 2" i GML vil man også sende med flate-objektets komplette egengeometri som gml:Surface. I tillegg er det definert regler for hvordan referansene til de assosierte avgrensningsobjektene skal utveksles:

. Referanse fra flateobjekt til avgrensningsobjekt legges som en _xlink:href_ på flateobjektet som peker på GML-Id for avgrensningsobjektet. Dette er i tråd med krav til - og erfaringer med - hvordan assosiasjoner utveksles på GML-formatet. 
. GML-Id utformes etter konvensjonen «objekttypenavn_lokalid» slik at denne er unik/meningsfull også på utsiden av GML-fila.
. Informasjon om rekkefølge og retning på de assosierte avgrensningsobjektene legges inn ved bruk av taggen _xlink:title_. I tilfellene der dette er interessant forutsettes det at _xlink:title_ formateres med 4 kolonner:
** Kolonne 1: sekvensnummer til flate – 0 er første flate (høyere tall ved multisurface/multipolygon)
** Kolonne 2: sekvensnummer til ring – ytre begrensing = 0, første hull = 1, osv.
** Kolonne 3: sekvensnummer til kurve - 0 er første
** Kolonne 4: retning + eller – (om avgrensningsobjektet skal nøstes med eller mot koordinatretningen)

.Eksempel på heleid flate på GML-format. Geometrien ligger "inline" i objektet.
[example]
[source,xml]
include::eksempel/flate_gml.xml[]

.Eksempel på flate med delt geometri i på GML-format. Flate-geometrien ligger "inline" i objektet og i tillegg ligger det inne referanser til egne avgrensningsobjekter som en assosiasjon med spesielle regler ("<avgrensning xlink:title="0 0 0 -" xlink:href="#Bygningsavgrensning_81ffc802-3e9f-492b-95b6-bb15b645a7e8"/>"). Det er krav om samsvar mellom geometrien til flata og de refererte avgrensningsobjektene.
[example]
[source,xml]
include::eksempel/flate_delt_gml.xml[]

<<<

[appendix]
== Generelle retningslinjer for fotogrammetrisk registrering av FKB (Normativt)

include::../felles/vedlegg_fotogrammetrisk_datafangst.adoc[]


:sectnums!:

<<<

[discrete]
== Lisensvilkår

// Inkluder lisensvilkår
include::../felles/lisensvilkaar.adoc[]

